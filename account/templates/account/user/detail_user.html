
{% extends "base.html" %}
{% load staticfiles %}
{% load thumbnail %}
{% block title %}{{ user.get_full_name }}{% endblock %}
{% block content %}
<main role="main" class="container">
<!--Контент -->
<h1>{{ user.get_full_name }}</h1>
    <div class="profile-info">
        {% if user.profile.photo %}
    {% thumbnail user.profile.photo "180x180" crop="100%" as im %}
    <img src="{{ im.url }}" class="user-detail">
        {% empty %}
        <p>No image</p>
    {% endthumbnail %}
<!--// -->
        {%else %}
    <img src="{% static "no_image_app_content.jpg" %}" class="img-responsive img-circle" width="120px" height="120px">
    {% endif %}
    </div>
    {% with total_followers=user.followers.count %}
        <span class="count">
            <span class="total">{{ total_followers }}</span>
            follower{{ total_followers|pluralize }}
        </span>
        <a href="#" data-id="{{ user.id }}" data-action="{% if request.user in user.followers.all %}
un{% endif %}follow" class="follow button">
{% if request.user not in user.followers.all %}
Follow
{% else %}
Unfollow
{% endif %}
</a>
{# your code to show the entry #}

<div id="image-list" class="image-container">
{% include "contents/content/list_ajax.html" with images=user.content_created.all %}
</div>
<!-- End Контент -->

</main>
{% endwith %}
{% endblock %}
{% block ajax_and_jquery %}
$('a.follow').click(function(e){
    e.preventDefault();
$.post('{% url "user_follow" %}',
{
id: $(this).data('id'),
    action: $(this).data('action')
},
function(data){
    if (data['status'] == 'ok')
{
var previous_action = $('a.follow').data('action');
// Нет данных (истекло время ожидания отправки данных).
$('a.follow').data('action', previous_action == 'follow' ? 'unfollow' : 'follow');
// toggle link text
$('a.follow').text(previous_action == 'follow' ? 'Unfollow' : 'Follow');
// Обновить общее количество подписчиков
var previous_followers = parseInt($('span.count .total').text());
$('span.count .total').text(previous_action == 'follow' ? previous_followers + 1 : previous_followers - 1);
}
});
});
{% endblock %}
 
